<?php

// TO DO:
// 1. fix everything
// 2. write at least two more questions
// 3. make suggestions based on questions

function pastry_quiz_menu() {
    $items['quiz'] = array(
        'title' => 'What should I eat!?',
        'page callback' => 'drupal_get_form',
        'page arguments' => array('start_form'),
        'access callback' => TRUE,
        'type' => MENU_NORMAL_ITEM,
    );

    $items['quiz_question_1'] = array(
        'page callback' => 'drupal_get_form',
        'page arguments' => array('quiz_form'),
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );

    $items['quiz_question_2'] = array(
        'page callback' => 'drupal_get_form',
        'page arguments' => array('question_two_form'),
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );

    // $items['quiz_question_3'] = array(
    //     'page callback' => 'drupal_get_form',
    //     'page arguments' => array('question_three_form'),
    //     'access callback' => TRUE,
    //     'type' => MENU_CALLBACK,
    // );

    $items['quiz_success'] = array(
        'title' => 'Quiz Results!',
        'page callback' => 'quiz_success',
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );

    return $items;
}

function quiz_form() {
  $form['gluten'] = array(
      '#title' => 'Gluten Intollerance',
      '#type' => 'radios',
      '#description' => t('Are you gluten intollerant?'),
      '#options' => array(
          'yes' => t('Yes!'),
          'no' => t('No, bring on the carbs!'),
      ),
      '#required' => TRUE,
  );

$form_state['redirect'] = 'quiz_question_2';

  return $form;
}

function question_two_form() {
  $form['sweet'] = array(
      '#title' => 'Gluten Intollerance',
      '#type' => 'radios',
      '#description' => t('Do you like sweets?'),
      '#options' => array(
          t('Yes'),
          t('No'),
      ),
      '#required' => TRUE,
  );
  // $form_state['redirect'] = 'quiz_question_3';
  $form['submit'] = array(
      '#type' => 'submit',
      '#value' => 'submit',
  );

  return $form;
}

// function question_two_form() {
//   $form['savory'] = array(
//       '#title' => 'Gluten Intollerance',
//       '#type' => 'radios',
//       '#description' => t('Are you gluten intollerant?'),
//       '#options' => array(
//           t('Yes'),
//           t('No'),
//       ),
//       '#required' => TRUE,
//   );
//
//   $form['submit'] = array(
//       '#type' => 'submit',
//       '#value' => 'submit',
//   );
//
//   return $form;
// }

function start_form() {

    $form['submit'] = array(
        '#type' => 'submit',
        '#value' => 'submit',
    );

    return $form;
}


function start_form_submit($form, &$form_state) {
  $form_state['redirect'] = 'quiz_question_1';
}

function quiz_form_submit($form, &$form_state) {
  // $form['gluten']['default_value'] = variable_get('comment_preview', 1);
  // $_SESSION['gluten'] = $gluten;
  // $form['gluten']['default_value'] = $form_state['values']['gluten'];
  $gluten = $form_state['values']['gluten'];
  $sweet = $form_state[['values']['sweet'];
  // $gluten = $form_state['values']['gluten'];
  // $form_state['redirect'] = 'quiz_results';

  // $savory = $_SESSION['values']['savory'];
  $quiz_suggestion = null;

  if ($gluten === 'yes') {
    $quiz_suggestion =  t('Try one of our daily gluten-free options!');
  } elseif ($gluten === 'no') {
    $quiz_suggestion =  t('You should try one of our doughnuts!');
  }



  $_SESSION['test_result'] = $quiz_suggestion;
  $form_state['redirect'] = 'quiz_success';
}

function quiz_success() {
  $quiz_ouput = $_SESSION['test_result'];
  return '<p>' . $quiz_ouput . '</p>';

  // return "success page obtained!";
  // if ($sweet === 'yes') {
  //   return '<p>get a donut!</p>';
  // } else {
  //   return "<p>cool! we've got stuff for you too!</p>";
  // }
  //
  // if ($savory === 'yes') {
  //   return '<p>get a donut!</p>';
  // } else {
  //   return "<p>cool! we've got stuff for you too!</p>";
  // }

}
